(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{146:function(e,t,a){e.exports=a(446)},152:function(e,t,a){},153:function(e,t,a){},443:function(e,t){},446:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(9),l=a.n(c),o=(a(151),a(152),a(153),a(145)),s=a(8),i=a(141),u={time:"",isConnected:!1,machines:[],lines:[],categories:[],selectedMachine:"",selectedLine:"",selectedCategory:"",selectedProductionPlan:{},selectedDate:"",selectedShift:"",selectedPro:"",shifts:[],pros:[],histories:[],weight:1};function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(a,!0).forEach(function(t){Object(i.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var h=function(e,t){switch(t.type){case"set_time":return m({},e,{time:t.value});case"set_connection":return m({},e,{isConnected:t.value});case"set_machines":return m({},e,{machines:t.value});case"set_lines":return m({},e,{lines:t.value});case"set_shifts":return m({},e,{shifts:t.value});case"set_categories":return m({},e,{categories:t.value});case"set_selected_machine":return m({},e,{selectedMachine:t.value});case"set_selected_line":return m({},e,{selectedLine:t.value});case"set_selected_category":return m({},e,{selectedCategory:t.value});case"set_selected_date":return m({},e,{selectedDate:t.value});case"set_selected_shift":return m({},e,{selectedShift:t.value});case"set_weight":return m({},e,{weight:t.value});case"set_selected_production_plan":return m({},e,{selectedProductionPlan:t.value});case"set_selected_pro":return m({},e,{selectedPro:t.value});case"set_pros":return m({},e,{pros:t.value});case"set_histories":return m({},e,{histories:t.value});case"clear_input":return m({},e,{selectedMachine:"",selectedLine:"",selectedCategory:"",selectedProductionPlan:{},selectedShift:"",selectedDate:"",selectedPro:"",pros:[],weight:1});default:return e}},f=r.a.createContext(),p=function(){return r.a.createElement("div",{className:"p-2 text-center uppercase font-bold border-solid border-2 border-red-600 text-red-600 rounded"},r.a.createElement("span",null,r.a.createElement(s.Icon,{name:"circle-close"})," Disconnected"))},g=function(){return r.a.createElement("div",{className:"p-2 text-center uppercase font-bold border-solid border-2 border-green-600 text-green-600 rounded"},r.a.createElement("span",null,r.a.createElement(s.Icon,{name:"circle-check"})," Connected"))},b=function(){var e=Object(n.useContext)(f).store;return r.a.createElement(s.Layout.Row,{gutter:"2",className:"select-none mt-4"},r.a.createElement(s.Layout.Col,{span:"6",offset:"3"},r.a.createElement("div",{className:"bg-blue-600 p-2 text-center uppercase text-white font-bold rounded border-solid border-2 border-blue-600"},"timbangan")),r.a.createElement(s.Layout.Col,{span:"6"},r.a.createElement("div",{className:"p-2 text-center uppercase font-bold border-solid border-2 border-blue-600 rounded"},e.time)),r.a.createElement(s.Layout.Col,{span:"6"},e.isConnected?r.a.createElement(g,null):r.a.createElement(p,null)))},v=function(){return r.a.createElement(s.Layout.Row,{gutter:"0",className:"pl-10 pr-10 pt-10 select-none"},r.a.createElement(s.Layout.Col,{span:"8"},r.a.createElement("div",{className:"uppercase font-bold bg-blue-600 p-2 rounded-l-lg text-center text-white"},"info")),r.a.createElement(s.Layout.Col,{span:"8"},r.a.createElement("div",{className:"uppercase font-bold bg-blue-600 p-2 text-center text-white"},"weight")),r.a.createElement(s.Layout.Col,{span:"8"},r.a.createElement("div",{className:"uppercase font-bold bg-blue-600 p-2 rounded-r-lg text-center text-white"},"history")))},E=a(142),y={API_MAIN:a.n(E).a.create({baseURL:"http://192.168.13.2:8081/api/v1/",timeout:3e4})},_=a(16),w=a.n(_),k=function(){var e=Object(n.useContext)(f),t=e.store,a=e.dispatch,c=function(){s.MessageBox.alert("There are no active PO on the selected shift or line.")};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("div",{className:"font-bold"},"Date"),r.a.createElement("div",null,r.a.createElement(s.DatePicker,{value:t.selectedDate,placeholder:"Pick a day",onChange:function(e){return a({type:"set_selected_date",value:e})},disabledDate:function(e){return e.getTime()<w()().subtract(2,"days")||e.getTime()>w()().subtract(0,"days")}}))),r.a.createElement(s.Layout.Row,null,r.a.createElement(s.Layout.Col,{span:"8"},r.a.createElement("div",{className:"font-bold"},"Shift"),r.a.createElement("div",null,r.a.createElement(s.Select,{disabled:!t.selectedDate,placeholder:"Select shift",size:"large",value:t.selectedShift,onChange:function(e){return a({type:"set_selected_shift",value:e})},loading:t.shifts.length<1},t.shifts.map(function(e){return r.a.createElement(s.Select.Option,{key:e.id,label:e.shift_name,value:e.id})})))),r.a.createElement(s.Layout.Col,{span:"8"},r.a.createElement("div",{className:"ml-2"},r.a.createElement("div",{className:"font-bold"},"Line"),r.a.createElement("div",null,r.a.createElement(s.Select,{disabled:!t.selectedShift,placeholder:"Select line",size:"large",value:t.selectedLine,onChange:function(e){return n=e,y.API_MAIN.get("rencana-produksi/find/shift?date=".concat(w()(t.selectedDate).format("YYYY-MM-DD"),"&shift_id=").concat(t.selectedShift,"&line_id=").concat(n),{headers:{Authorization:"bearer ".concat(localStorage.getItem("token"))}}).then(function(e){var t=e.data;t.length>0?a({type:"set_pros",value:t}):(c(),a({type:"clear_input"}))}).catch(function(e){console.error(e),c(),a({type:"clear_input"})}),void a({type:"set_selected_line",value:n});var n},loading:t.lines.length<1},t.lines.map(function(e){return r.a.createElement(s.Select.Option,{key:e.id,label:e.name,value:e.id})})))))),r.a.createElement(s.Layout.Row,null,r.a.createElement(s.Layout.Col,{span:"8"},r.a.createElement("div",{className:"font-bold"},"PrO"),r.a.createElement("div",null,r.a.createElement(s.Select,{disabled:t.pros.length<1,placeholder:"Select PrO",size:"large",value:t.selectedPro,onChange:function(e){a({type:"set_selected_pro",value:e})},loading:t.pros.length<1},t.pros.map(function(e){return r.a.createElement(s.Select.Option,{key:e.id,label:e.po_number,value:e.id})})))),r.a.createElement(s.Layout.Col,{span:"8"},r.a.createElement("div",{className:"ml-2"},r.a.createElement("div",{className:"font-bold"},"Machine"),r.a.createElement("div",null,r.a.createElement(s.Select,{disabled:!t.selectedPro,placeholder:"Select mesin",size:"large",value:t.selectedMachine,onChange:function(e){return a({type:"set_selected_machine",value:e})},loading:t.machines.length<1},t.machines.map(function(e){return r.a.createElement(s.Select.Option,{key:e.id,label:e.name,value:e.id})})))))),r.a.createElement("div",null,r.a.createElement("div",{className:"font-bold"},"Category"),r.a.createElement("div",null,r.a.createElement(s.Select,{disabled:!t.selectedMachine,placeholder:"Select kategori",size:"large",value:t.selectedCategory,onChange:function(e){return a({type:"set_selected_category",value:e})},loading:t.lines.length<1},t.categories.map(function(e){return r.a.createElement(s.Select.Option,{key:e.id,label:e.category,value:e.id})})))))},I=a(143),C=a.n(I)()("http://localhost:9552"),P=function(){var e=Object(n.useContext)(f),t=e.store,a=e.dispatch;return Object(n.useEffect)(function(){C.on("weight_streaming",function(e){return a({type:"set_weight",value:e})})},[a]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"ml-4"},r.a.createElement("div",{className:"font-bold"},"Weight (Kg)"),r.a.createElement("div",{className:"p-2 w-4/5 text-2xl text-center border font-bold h rounded border-gray-500"},t.weight),r.a.createElement("div",{className:"mt-2"},r.a.createElement(s.Button,{type:"warning",size:"large",icon:"circle-check",className:"w-4/5",onClick:function(){var e=t.machines.filter(function(e){return e.id===t.selectedMachine})[0].name,n=t.lines.filter(function(e){return e.id===t.selectedLine})[0].name,r=t.categories.filter(function(e){return e.id===t.selectedCategory})[0].category;s.MessageBox.confirm("Dengan ini akan dikirimkan data sebagai berikut: Mesin ".concat(e,", ").concat(n,", Kategori ").concat(r,", dan Berat ").concat(t.weight," Kg. apakah sudah benar ?"),"Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){y.API_MAIN.post("badstock/timbangan",{weight_kg:t.weight,rencanaProduksiId:t.selectedPro,machineId:t.selectedMachine,badstockCategoryId:t.selectedCategory}).then(function(e){var t;e.data.success&&(Object(s.Message)({type:"success",message:"Sent!"}),t=localStorage.getItem("token"),y.API_MAIN.get("badstock/timbangan/history?date=".concat(w()().format("YYYY-MM-DD")),{headers:{Authorization:"bearer ".concat(t)}}).then(function(e){return a({type:"set_histories",value:e.data})}).catch(function(e){return console.err(e)}),a({type:"clear_input"}))}).catch(function(e){return console.error(e)})}).catch(function(){Object(s.Message)({type:"info",message:"Canceled"})})},disabled:!t.selectedMachine||!t.selectedLine||!t.selectedCategory||!t.selectedProductionPlan},"Send"))))},N=function(){var e=Object(n.useContext)(f),t=e.store;e.dispatch;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"rounded overflow-auto mt-2 h-64 p-2 border border-blue-600 w-full"},t.histories.map(function(e,a){return r.a.createElement("div",{key:a,className:"mb-2 border-b-2 border-blue-600"},r.a.createElement("table",{className:"m-0 p-0"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,a+1,"."),r.a.createElement("td",null,e.machine.name),r.a.createElement("td",null,"|"),r.a.createElement("td",null,e.badstock_category.category)),r.a.createElement("tr",null,r.a.createElement("td",null),r.a.createElement("td",null,t.lines.filter(function(t){return t.id===e.rencana_produksi.lineId})[0].name),r.a.createElement("td",null),r.a.createElement("td",null)),r.a.createElement("tr",null,r.a.createElement("td",null),r.a.createElement("td",null,w()(e.created_at).tz("utc").format("DD MM YYYY")),r.a.createElement("td",null,"|"),r.a.createElement("td",null,w()(e.created_at).tz("utc").format("HH:mm:ss"))))))})))},O=function(){return r.a.createElement(s.Layout.Row,{gutter:"2",className:"pl-10 pr-10 mt-2"},r.a.createElement(s.Layout.Col,{span:"8"},r.a.createElement(k,null)),r.a.createElement(s.Layout.Col,{span:"8"},r.a.createElement(P,null)),r.a.createElement(s.Layout.Col,{span:"8"},r.a.createElement(N,null)))},M=function(){var e=Object(n.useReducer)(h,u),t=Object(o.a)(e,2),a=t[0],c=t[1],l=function(e){y.API_MAIN.get("badstock/timbangan/history?date=".concat(w()().format("YYYY-MM-DD")),{headers:{Authorization:"bearer ".concat(e)}}).then(function(e){return c({type:"set_histories",value:e.data})}).catch(function(e){return console.err(e)})},s=function(){y.API_MAIN.get("machine").then(function(e){return c({type:"set_machines",value:e.data})}).catch(function(e){return console.error(e)})},i=function(){y.API_MAIN.get("initial-shift").then(function(e){return c({type:"set_shifts",value:e.data})}).catch(function(e){return console.error(e)})},d=function(){y.API_MAIN.get("line").then(function(e){return c({type:"set_lines",value:e.data})}).catch(function(e){return console.error(e)})},m=function(e){y.API_MAIN.get("badstock-category",{headers:{Authorization:"bearer ".concat(e)}}).then(function(e){return c({type:"set_categories",value:e.data})}).catch(function(e){return console.error(e)})};return Object(n.useEffect)(function(){var e=setInterval(function(){return c({type:"set_time",value:w()().format("HH:mm:ss")})},1e3),t=setInterval(function(){y.API_MAIN.get("line").then(function(){return c({type:"set_connection",value:!0})}).catch(function(){return c({type:"set_connection",value:!1})}),l(localStorage.getItem("token"))},5e3);return localStorage.getItem("token")?(s(),d(),m(localStorage.getItem("token")),i(),l(localStorage.getItem("token"))):y.API_MAIN.post("auth/login",{username:"operator",password:"operator",roleId:2}).then(function(e){localStorage.setItem("token",e.data.accessToken),s(),d(),m(e.data.accessToken),i(),l(e.data.accessToken)}).catch(function(e){console.error(e)}),function(){clearInterval(e),clearInterval(t),e=t=null}},[]),r.a.createElement(f.Provider,{value:{store:a,dispatch:c}},r.a.createElement(b,null),r.a.createElement(v,null),r.a.createElement(O,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var S=a(144);s.i18n.use(S.a),l.a.render(r.a.createElement(M,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[146,1,2]]]);
//# sourceMappingURL=main.20f474c3.chunk.js.map